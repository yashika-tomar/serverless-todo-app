{"filter":false,"title":"serverless.yml","tooltip":"/project-final-initial/cd12101-Deploy-Application-with-AWS-Lambda/starter/backend/serverless.yml","undoManager":{"mark":14,"position":14,"stack":[[{"start":{"row":0,"column":0},"end":{"row":148,"column":37},"action":"remove","lines":["service: serverless-todo-app","","frameworkVersion: '3'","","plugins:","  - serverless-iam-roles-per-function","","provider:","  name: aws","  runtime: nodejs16.x","  stage: dev","  region: us-east-1","  environment:","    TODOS_TABLE: ${self:service}-todos-${self:provider.stage}","    TODOS_CREATED_AT_INDEX: CreatedAtIndex","    ATTACHMENTS_BUCKET: ${self:service}-attachments-${self:provider.stage}","    AUTH0_AUDIENCE: https://todo-api-dev/","    AUTH0_DOMAIN: dev-swyiahy623v6dfat.us.auth0.com","    ","","functions:","","  Auth:","    handler: src/lambda/auth/auth0Authorizer.handler","","  GetTodos:","    handler: src/lambda/http/getTodos.handler","    events:","      - http:","          method: get","          path: todos","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:Query","        Resource: ","          - arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","          - arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}/index/${self:provider.environment.TODOS_CREATED_AT_INDEX}","","  CreateTodo:","    handler: src/lambda/http/createTodo.handler","    events:","      - http:","          method: post","          path: todos","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:PutItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  UpdateTodo:","    handler: src/lambda/http/updateTodo.handler","    events:","      - http:","          method: patch","          path: todos/{todoId}","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:UpdateItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  DeleteTodo:","    handler: src/lambda/http/deleteTodo.handler","    events:","      - http:","          method: delete","          path: todos/{todoId}","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:DeleteItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  GenerateUploadUrl:","    handler: src/lambda/http/generateUploadUrl.handler","    events:","      - http:","          method: post","          path: todos/{todoId}/attachment","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - s3:PutObject","          - s3:GetObject","        Resource: arn:aws:s3:::${self:provider.environment.ATTACHMENTS_BUCKET}/*","","resources:","  Resources:","","    TodosTable:","      Type: AWS::DynamoDB::Table","      Properties:","        AttributeDefinitions:","          - AttributeName: userId","            AttributeType: S","          - AttributeName: todoId","            AttributeType: S","          - AttributeName: createdAt","            AttributeType: S","        KeySchema:","          - AttributeName: userId","            KeyType: HASH","          - AttributeName: todoId","            KeyType: RANGE","        BillingMode: PAY_PER_REQUEST","        LocalSecondaryIndexes:","          - IndexName: ${self:provider.environment.TODOS_CREATED_AT_INDEX}","            KeySchema:","              - AttributeName: userId","                KeyType: HASH","              - AttributeName: createdAt","                KeyType: RANGE","            Projection:","              ProjectionType: ALL","","    AttachmentsBucket:","      Type: AWS::S3::Bucket","      Properties:","        CorsConfiguration:","          CorsRules:","            - AllowedOrigins:","                - \"*\"","              AllowedHeaders:","                - \"*\"","              AllowedMethods:","                - GET","                - PUT","                - POST","                - DELETE","                - HEAD","        VersioningConfiguration:","          Status: Enabled","        PublicAccessBlockConfiguration:","          BlockPublicAcls: true","          BlockPublicPolicy: true","          IgnorePublicAcls: true","          RestrictPublicBuckets: true"],"id":6},{"start":{"row":0,"column":0},"end":{"row":174,"column":0},"action":"insert","lines":["service: serverless-todo-app","","frameworkVersion: '3'","","plugins:","  - serverless-iam-roles-per-function","","provider:","  name: aws","  runtime: nodejs16.x","  stage: dev","  region: us-east-1","  environment:","    TODOS_TABLE: ${self:service}-todos-${self:provider.stage}","    TODOS_CREATED_AT_INDEX: CreatedAtIndex","    ATTACHMENTS_BUCKET: ${self:service}-attachments-${self:provider.stage}","    AUTH0_AUDIENCE: https://todo-api-dev/","    AUTH0_DOMAIN: dev-swyiahy623v6dfat.us.auth0.com","","functions:","","  # --------------------","  # AUTHORIZER FUNCTION","  # --------------------","  Auth:","    handler: src/lambda/auth/auth0Authorizer.handler","","  # --------------------","  # GET TODOS","  # --------------------","  GetTodos:","    handler: src/lambda/http/getTodos.handler","    events:","      - http:","          method: get","          path: todos","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:Query","        Resource:","          - arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","          - arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}/index/${self:provider.environment.TODOS_CREATED_AT_INDEX}","","  # --------------------","  # CREATE TODO","  # --------------------","  CreateTodo:","    handler: src/lambda/http/createTodo.handler","    events:","      - http:","          method: post","          path: todos","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:PutItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  # --------------------","  # UPDATE TODO","  # --------------------","  UpdateTodo:","    handler: src/lambda/http/updateTodo.handler","    events:","      - http:","          method: patch","          path: todos/{todoId}","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:UpdateItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  # --------------------","  # DELETE TODO","  # --------------------","  DeleteTodo:","    handler: src/lambda/http/deleteTodo.handler","    events:","      - http:","          method: delete","          path: todos/{todoId}","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - dynamodb:DeleteItem","        Resource: arn:aws:dynamodb:${self:provider.region}:*:table/${self:provider.environment.TODOS_TABLE}","","  # --------------------","  # GENERATE UPLOAD URL","  # --------------------","  GenerateUploadUrl:","    handler: src/lambda/http/generateUploadUrl.handler","    events:","      - http:","          method: post","          path: todos/{todoId}/attachment","          cors: true","          authorizer: Auth","    iamRoleStatements:","      - Effect: Allow","        Action:","          - s3:PutObject","          - s3:GetObject","        Resource: arn:aws:s3:::${self:provider.environment.ATTACHMENTS_BUCKET}/*","","resources:","  Resources:","","    # --------------------","    # DYNAMODB TABLE","    # --------------------","    TodosTable:","      Type: AWS::DynamoDB::Table","      Properties:","        TableName: ${self:provider.environment.TODOS_TABLE}","        AttributeDefinitions:","          - AttributeName: userId","            AttributeType: S","          - AttributeName: todoId","            AttributeType: S","          - AttributeName: createdAt","            AttributeType: S","        KeySchema:","          - AttributeName: userId","            KeyType: HASH","          - AttributeName: todoId","            KeyType: RANGE","        BillingMode: PAY_PER_REQUEST","        LocalSecondaryIndexes:","          - IndexName: ${self:provider.environment.TODOS_CREATED_AT_INDEX}","            KeySchema:","              - AttributeName: userId","                KeyType: HASH","              - AttributeName: createdAt","                KeyType: RANGE","            Projection:","              ProjectionType: ALL","","    # --------------------","    # S3 BUCKET FOR ATTACHMENTS","    # --------------------","    AttachmentsBucket:","      Type: AWS::S3::Bucket","      Properties:","        BucketName: ${self:provider.environment.ATTACHMENTS_BUCKET}","        CorsConfiguration:","          CorsRules:","            - AllowedOrigins:","                - \"*\"","              AllowedHeaders:","                - \"*\"","              AllowedMethods:","                - GET","                - PUT","                - POST","                - DELETE","                - HEAD","        VersioningConfiguration:","          Status: Enabled","        PublicAccessBlockConfiguration:","          BlockPublicAcls: true","          BlockPublicPolicy: true","          IgnorePublicAcls: true","          RestrictPublicBuckets: true",""]}],[{"start":{"row":147,"column":0},"end":{"row":150,"column":26},"action":"remove","lines":["","    # --------------------","    # S3 BUCKET FOR ATTACHMENTS","    # --------------------"],"id":7}],[{"start":{"row":118,"column":1},"end":{"row":120,"column":26},"action":"remove","lines":["   # --------------------","    # DYNAMODB TABLE","    # --------------------"],"id":8}],[{"start":{"row":97,"column":0},"end":{"row":99,"column":24},"action":"remove","lines":["  # --------------------","  # GENERATE UPLOAD URL","  # --------------------"],"id":9}],[{"start":{"row":80,"column":1},"end":{"row":82,"column":24},"action":"remove","lines":[" # --------------------","  # DELETE TODO","  # --------------------"],"id":10}],[{"start":{"row":80,"column":0},"end":{"row":80,"column":1},"action":"remove","lines":[" "],"id":11}],[{"start":{"row":79,"column":0},"end":{"row":80,"column":0},"action":"remove","lines":["",""],"id":12}],[{"start":{"row":93,"column":0},"end":{"row":94,"column":0},"action":"remove","lines":["",""],"id":13}],[{"start":{"row":63,"column":2},"end":{"row":65,"column":24},"action":"remove","lines":["# --------------------","  # UPDATE TODO","  # --------------------"],"id":14},{"start":{"row":63,"column":0},"end":{"row":63,"column":2},"action":"remove","lines":["  "]},{"start":{"row":62,"column":0},"end":{"row":63,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":46,"column":1},"end":{"row":48,"column":24},"action":"remove","lines":[" # --------------------","  # CREATE TODO","  # --------------------"],"id":15},{"start":{"row":46,"column":0},"end":{"row":46,"column":1},"action":"remove","lines":[" "]},{"start":{"row":45,"column":0},"end":{"row":46,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":27,"column":1},"end":{"row":29,"column":24},"action":"remove","lines":[" # --------------------","  # GET TODOS","  # --------------------"],"id":16},{"start":{"row":27,"column":0},"end":{"row":27,"column":1},"action":"remove","lines":[" "]},{"start":{"row":26,"column":0},"end":{"row":27,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":21,"column":1},"end":{"row":23,"column":24},"action":"remove","lines":[" # --------------------","  # AUTHORIZER FUNCTION","  # --------------------"],"id":17},{"start":{"row":21,"column":0},"end":{"row":21,"column":1},"action":"remove","lines":[" "]},{"start":{"row":20,"column":0},"end":{"row":21,"column":0},"action":"remove","lines":["",""]}],[{"start":{"row":131,"column":67},"end":{"row":131,"column":73},"action":"insert","lines":["-yt123"],"id":18}],[{"start":{"row":131,"column":8},"end":{"row":131,"column":73},"action":"remove","lines":["BucketName: ${self:provider.environment.ATTACHMENTS_BUCKET}-yt123"],"id":19},{"start":{"row":131,"column":8},"end":{"row":131,"column":67},"action":"insert","lines":["BucketName: ${self:provider.environment.ATTACHMENTS_BUCKET}"]}],[{"start":{"row":15,"column":74},"end":{"row":15,"column":80},"action":"insert","lines":["-yt123"],"id":20}]]},"ace":{"folds":[],"scrolltop":44.66666982203406,"scrollleft":0,"selection":{"start":{"row":15,"column":80},"end":{"row":15,"column":80},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1763842703258,"hash":"099eaf1d38461093e57d0b53eff1d2022933404c"}