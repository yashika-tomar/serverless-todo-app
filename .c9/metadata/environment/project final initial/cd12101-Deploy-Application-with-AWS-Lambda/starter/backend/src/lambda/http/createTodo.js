{"filter":false,"title":"createTodo.js","tooltip":"/project final initial/cd12101-Deploy-Application-with-AWS-Lambda/starter/backend/src/lambda/http/createTodo.js","undoManager":{"mark":4,"position":4,"stack":[[{"start":{"row":0,"column":0},"end":{"row":8,"column":0},"action":"remove","lines":["","export function handler(event) {","  const newTodo = JSON.parse(event.body)","","  // TODO: Implement creating a new TODO item","  return undefined","}","",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":43,"column":1},"action":"insert","lines":["import AWS from 'aws-sdk'","import { v4 as uuid } from 'uuid'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const newTodo = JSON.parse(event.body)","","  try {","    // Add unique ID and timestamp","    const todoItem = {","      todoId: uuid(),","      userId: event.requestContext.authorizer.userId,","      name: newTodo.name,","      dueDate: newTodo.dueDate,","      done: false,","      createdAt: new Date().toISOString()","    }","","    // Save to DynamoDB","    await docClient","      .put({","        TableName: todosTable,","        Item: todoItem","      })","      .promise()","","    logger.info('Created new TODO', { todoItem })","","    return {","      statusCode: 201,","      body: JSON.stringify({ item: todoItem })","    }","  } catch (error) {","    logger.error('Error creating TODO', { error })","    return {","      statusCode: 500,","      body: JSON.stringify({ error: 'Could not create TODO' })","    }","  }","}"]}],[{"start":{"row":33,"column":22},"end":{"row":34,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":34,"column":0},"end":{"row":34,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":34,"column":6},"end":{"row":38,"column":0},"action":"insert","lines":["headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},",""],"id":4}],[{"start":{"row":0,"column":0},"end":{"row":48,"column":1},"action":"remove","lines":["import AWS from 'aws-sdk'","import { v4 as uuid } from 'uuid'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const newTodo = JSON.parse(event.body)","","  try {","    // Add unique ID and timestamp","    const todoItem = {","      todoId: uuid(),","      userId: event.requestContext.authorizer.userId,","      name: newTodo.name,","      dueDate: newTodo.dueDate,","      done: false,","      createdAt: new Date().toISOString()","    }","","    // Save to DynamoDB","    await docClient","      .put({","        TableName: todosTable,","        Item: todoItem","      })","      .promise()","","    logger.info('Created new TODO', { todoItem })","","    return {","      statusCode: 201,","      headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},","","      body: JSON.stringify({ item: todoItem })","    }","  } catch (error) {","    logger.error('Error creating TODO', { error })","    return {","      statusCode: 500,","      body: JSON.stringify({ error: 'Could not create TODO' })","    }","  }","}"],"id":11},{"start":{"row":0,"column":0},"end":{"row":54,"column":0},"action":"insert","lines":["import AWS from 'aws-sdk'","import { v4 as uuid } from 'uuid'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const newTodo = JSON.parse(event.body)","","  try {","    // Use principalId from the authorizer","    const userId = event.requestContext.authorizer.principalId","","    const todoItem = {","      todoId: uuid(),","      userId: userId,","      name: newTodo.name,","      dueDate: newTodo.dueDate,","      done: false,","      createdAt: new Date().toISOString()","    }","","    // Save to DynamoDB","    await docClient.put({","      TableName: todosTable,","      Item: todoItem","    }).promise()","","    logger.info('Created new TODO', { todoItem })","","    return {","      statusCode: 201,","      headers: {","        \"Access-Control-Allow-Origin\": \"*\",","        \"Access-Control-Allow-Credentials\": true","      },","      body: JSON.stringify({ item: todoItem })","    }","","  } catch (error) {","    logger.error('Error creating TODO', { error })","","    return {","      statusCode: 500,","      headers: {","        \"Access-Control-Allow-Origin\": \"*\",","        \"Access-Control-Allow-Credentials\": true","      },","      body: JSON.stringify({ error: 'Could not create TODO' })","    }","  }","}",""]}],[{"start":{"row":12,"column":3},"end":{"row":12,"column":42},"action":"remove","lines":[" // Use principalId from the authorizer"],"id":12}]]},"ace":{"folds":[],"scrolltop":86.66667278902074,"scrollleft":0,"selection":{"start":{"row":13,"column":4},"end":{"row":13,"column":62},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":5,"state":"no_regex","mode":"ace/mode/javascript"}},"timestamp":1763838657298,"hash":"c782cfe2f2250fa33834936eb81904247023f869"}