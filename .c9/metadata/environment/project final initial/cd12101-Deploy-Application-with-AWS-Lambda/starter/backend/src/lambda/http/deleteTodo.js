{"filter":false,"title":"deleteTodo.js","tooltip":"/project final initial/cd12101-Deploy-Application-with-AWS-Lambda/starter/backend/src/lambda/http/deleteTodo.js","undoManager":{"mark":8,"position":8,"stack":[[{"start":{"row":0,"column":0},"end":{"row":8,"column":0},"action":"remove","lines":["","export function handler(event) {","  const todoId = event.pathParameters.todoId","","  // TODO: Remove a TODO item by id","  return undefined","}","",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":35,"column":1},"action":"insert","lines":["import AWS from 'aws-sdk'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const todoId = event.pathParameters.todoId","","  try {","    // Delete the TODO item from DynamoDB","    await docClient","      .delete({","        TableName: todosTable,","        Key: {","          todoId: todoId,","          userId: event.requestContext.authorizer.userId","        }","      })","      .promise()","","    logger.info('Deleted TODO', { todoId })","","    return {","      statusCode: 200,","      body: JSON.stringify({ message: 'Todo deleted successfully' })","    }","  } catch (error) {","    logger.error('Error deleting TODO', { error })","    return {","      statusCode: 500,","      body: JSON.stringify({ error: 'Could not delete TODO' })","    }","  }","}"]}],[{"start":{"row":25,"column":22},"end":{"row":26,"column":0},"action":"insert","lines":["",""],"id":3},{"start":{"row":26,"column":0},"end":{"row":26,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":26,"column":6},"end":{"row":30,"column":0},"action":"insert","lines":["headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},",""],"id":4}],[{"start":{"row":36,"column":22},"end":{"row":37,"column":0},"action":"insert","lines":["",""],"id":5},{"start":{"row":37,"column":0},"end":{"row":37,"column":6},"action":"insert","lines":["      "]}],[{"start":{"row":37,"column":6},"end":{"row":41,"column":0},"action":"insert","lines":["headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},",""],"id":6}],[{"start":{"row":11,"column":41},"end":{"row":12,"column":0},"action":"insert","lines":["",""],"id":7},{"start":{"row":12,"column":0},"end":{"row":12,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":12,"column":4},"end":{"row":12,"column":62},"action":"insert","lines":["const userId = event.requestContext.authorizer.principalId"],"id":8}],[{"start":{"row":12,"column":62},"end":{"row":13,"column":0},"action":"insert","lines":["",""],"id":9},{"start":{"row":13,"column":0},"end":{"row":13,"column":4},"action":"insert","lines":["    "]}],[{"start":{"row":0,"column":0},"end":{"row":47,"column":1},"action":"remove","lines":["import AWS from 'aws-sdk'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const todoId = event.pathParameters.todoId","","  try {","    // Delete the TODO item from DynamoDB","    const userId = event.requestContext.authorizer.principalId","    ","    await docClient","      .delete({","        TableName: todosTable,","        Key: {","          todoId: todoId,","          userId: event.requestContext.authorizer.userId","        }","      })","      .promise()","","    logger.info('Deleted TODO', { todoId })","","    return {","      statusCode: 200,","      headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},","","      body: JSON.stringify({ message: 'Todo deleted successfully' })","    }","  } catch (error) {","    logger.error('Error deleting TODO', { error })","    return {","      statusCode: 500,","      headers: {","  \"Access-Control-Allow-Origin\": \"*\",","  \"Access-Control-Allow-Credentials\": true","},","","      body: JSON.stringify({ error: 'Could not delete TODO' })","    }","  }","}"],"id":10},{"start":{"row":0,"column":0},"end":{"row":47,"column":0},"action":"insert","lines":["import AWS from 'aws-sdk'","import { createLogger } from '../../utils/logger.mjs'","","const logger = createLogger('todos')","const docClient = new AWS.DynamoDB.DocumentClient()","const todosTable = process.env.TODOS_TABLE","","export async function handler(event) {","  const todoId = event.pathParameters.todoId","","  try {","    // Correct userId from authorizer","    const userId = event.requestContext.authorizer.principalId","","    // Delete the TODO item from DynamoDB","    await docClient.delete({","      TableName: todosTable,","      Key: {","        userId: userId,","        todoId: todoId","      }","    }).promise()","","    logger.info('Deleted TODO', { todoId, userId })","","    return {","      statusCode: 200,","      headers: {","        \"Access-Control-Allow-Origin\": \"*\",","        \"Access-Control-Allow-Credentials\": true","      },","      body: JSON.stringify({ message: 'Todo deleted successfully' })","    }","","  } catch (error) {","    logger.error('Error deleting TODO', { error })","","    return {","      statusCode: 500,","      headers: {","        \"Access-Control-Allow-Origin\": \"*\",","        \"Access-Control-Allow-Credentials\": true","      },","      body: JSON.stringify({ error: 'Could not delete TODO' })","    }","  }","}",""]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":47,"column":0},"end":{"row":47,"column":0},"isBackwards":false},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1763838650908,"hash":"539fda2bd99c2f34d4a6659e9256a13d90f2ace6"}